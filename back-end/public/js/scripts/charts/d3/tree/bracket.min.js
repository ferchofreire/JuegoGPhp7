$(window).on("load",(function(){var t,e=d3.select("#bracket-tree"),n=0,r=0,i=0,a=0,l=e.node().getBoundingClientRect().width-a-r,o=l/2,c=600-n-i-5,s=0,u=e.append("svg"),d=u.attr("width",l+a+r).attr("height",c+n+i).append("g").attr("transform","translate("+a+","+n+")"),h=d3.behavior.zoom().scaleExtent([1,2]).on("zoom",(function(){d.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}));u.call(h);var f=d3.layout.tree().size([c,l]),y=(d3.svg.diagonal().projection((function(t){return[t.y,t.x]})),function(t,e){var n=g(t.source),r=g(t.target),i=(r.y-n.y)/2;return t.isRight&&(i=-i),"M"+n.y+","+n.x+"H"+(n.y+i)+"V"+r.x+"H"+r.y}),g=function(t){var e=t.y;return t.isRight||(e=t.y-o,e=o-e),{x:t.x,y:e}},v=function(t,e){e=e||[];var n=0,r=t.children?t.children.length:0;for(e.push(t);n<r;n++)v(t.children[n],e);return e};d3.json("../../../app-assets/data/d3/tree/bracket-tree.json",(function(n){(t=n).x0=c/2,t.y0=l/2;var i=d3.layout.tree().size([c,o]).children((function(t){return t.winners})),h=d3.layout.tree().size([c,o]).children((function(t){return t.challengers}));i.nodes(t),h.nodes(t);var x=function(t){t.children=function(t){var e=[];if(t.winners)for(var n=0;n<t.winners.length;n++)t.winners[n].isRight=!1,t.winners[n].parent=t,e.push(t.winners[n]);if(t.challengers)for(n=0;n<t.challengers.length;n++)t.challengers[n].isRight=!0,t.challengers[n].parent=t,e.push(t.challengers[n]);return e.length?e:null}(t),t.children&&t.children.forEach(x)};x(t),t.isRight=!1,function t(n){var i=v(n);i.forEach((function(t){t.y=180*t.depth+o}));var c=d.selectAll("g.node").data(i,(function(t){return t.id||(t.id=++s)}));i.forEach((function(t){var e=g(t);t.x0=e.x,t.y0=e.y}));var h=c.enter().append("g").attr("class","node").attr("transform",(function(t){return"translate("+n.y0+","+n.x0+")"})).on("click",k);h.append("circle").attr("r",1e-6).style("stroke","#F6BB42").style("stroke-width",1.5).style("cursor","pointer").style("fill",(function(t){return t._children?"#F6BB42":"#fff"})),h.append("text").attr("dy",(function(t){return t.isRight?18:-12})).attr("text-anchor","middle").text((function(t){return t.name})).style("font-size",12).style("fill-opacity",1e-6);var x=c.transition().duration(500).attr("transform",(function(t){return p=g(t),"translate("+p.y+","+p.x+")"}));x.select("circle").attr("r",4.5).style("fill",(function(t){return t._children?"#F6BB42":"#fff"})),x.select("text").style("fill-opacity",1);var w=c.exit().transition().duration(500).attr("transform",(function(t){return p=g(t.parent||n),"translate("+p.y+","+p.x+")"})).remove();w.select("circle").attr("r",1e-6),w.select("text").style("fill-opacity",1e-6);var m=d.selectAll("path.link").data(f.links(i),(function(t){return t.target.id}));function k(e){e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),t(n)}function B(){l=e.node().getBoundingClientRect().width-a-r,u.attr("width",l+a+r),d.attr("width",l+a+r)}m.enter().insert("path","g").attr("class","link").style("stroke","#F6BB42").style("fill","none").style("stroke-width",1.5).attr("d",(function(t){var e={x:n.x0,y:n.y0};return y({source:e,target:e})})),m.transition().duration(500).attr("d",y),m.exit().transition().duration(500).attr("d",(function(t){var e=g(t.source||n);return t.source.isRight?e.y-=o-(t.target.y-t.source.y):e.y+=o-(t.target.y-t.source.y),y({source:e,target:e})})).remove(),$(window).on("resize",B),$(".menu-toggle").on("click",B)}(t)}))}));