$(window).on("load",(function(){var t,e=d3.select("#collapsible-tree"),n=20,r=20,i=30,l=50,a=e.node().getBoundingClientRect().width-l-r,o=600-n-i,c=0,d=e.append("svg"),s=d.attr("width",a+l+r).attr("height",o+n+i).append("g").attr("transform","translate("+l+","+n+")"),u=d3.layout.tree().size([o,a-180]),f=d3.svg.diagonal().projection((function(t){return[t.y,t.x]}));function h(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null)}d3.json("../../../app-assets/data/d3/tree/collapsible-tree.json",(function(n,i){(t=i).x0=o/2,t.y0=0,t.children.forEach((function t(e){e.children&&(e.children.forEach(t),h(e))})),h(t.children[1]),h(t.children[1].children[2]),h(t.children[9]),h(t.children[9].children[0]),function n(i){var y=d3.event&&d3.event.altKey?5e3:500,p=u.nodes(t).reverse(),x=s.selectAll(".d3-tree-node").data(p,(function(t){return t.id||(t.id=++c)})),g=x.enter().append("g").attr("class","d3-tree-node").attr("transform",(function(t){return"translate("+i.y0+","+i.x0+")"})).on("click",(function(t){h(t),n(t)}));g.append("circle").attr("r",1e-6).style("fill","#fff").style("stroke","#E84A5F").style("stroke-width",1.5).style("cursor","pointer").style("fill",(function(t){return t._children?"#E84A5F":"#fff"})),g.append("text").attr("x",(function(t){return t.children||t._children?-10:10})).attr("dy",".35em").style("text-anchor",(function(t){return t.children||t._children?"end":"start"})).style("font-size",12).style("fill-opacity",1e-6).text((function(t){return t.name}));var v=x.transition().duration(y).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"}));v.select("circle").attr("r",4.5).style("fill",(function(t){return t._children?"#E84A5F":"#fff"})),v.select("text").style("fill-opacity",1);var k=x.exit().transition().duration(y).attr("transform",(function(t){return"translate("+i.y+","+i.x+")"})).remove();k.select("circle").attr("r",1e-6),k.select("text").style("fill-opacity",1e-6);var w=s.selectAll(".d3-tree-link").data(u.links(p),(function(t){return t.target.id}));function m(){a=e.node().getBoundingClientRect().width-l-r,p=u.nodes(t),links=u.links(p),d.attr("width",a+l+r),s.attr("width",a+l+r),u.size([o,a-180]),f.projection((function(t){return[t.y,t.x]})),s.selectAll(".d3-tree-link").attr("d",f),s.selectAll(".d3-tree-node").attr("transform",(function(t){return"translate("+t.y+","+t.x+")"}))}w.enter().insert("path","g").attr("class","d3-tree-link").style("fill","none").style("stroke","#e3e3e3").style("stroke-width",1.5).attr("d",(function(t){var e={x:i.x0,y:i.y0};return f({source:e,target:e})})).transition().duration(y).attr("d",f),w.transition().duration(y).attr("d",f),w.exit().transition().duration(y).attr("d",(function(t){var e={x:i.x,y:i.y};return f({source:e,target:e})})).remove(),p.forEach((function(t){t.x0=t.x,t.y0=t.y})),$(window).on("resize",m),$(".menu-toggle, .d3-tree-node circle").on("click",m)}(t)}))}));