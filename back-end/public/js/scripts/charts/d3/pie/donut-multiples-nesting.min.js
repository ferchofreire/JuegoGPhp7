$(window).on("load",(function(){var t=d3.select("#nested-donut"),e=20,n=10,r=10,a=300;radius=(Math.min(a,300)-2*e)/2;var i=d3.scale.ordinal().range(["#99B898","#FECEA8","#FF847C","#E84A5F","#F8B195","#F67280","#C06C84"]);function d(){a=t.node().getBoundingClientRect().width-r-n,container.attr("width",a+r+n),svg.attr("width",a+r+n),x.range([0,a]),svg.selectAll(".d3-xaxis").call(xAxis),svg.selectAll(".d3-line").attr("d",line)}d3.csv("../../../app-assets/data/d3/pie/flights.csv",(function(e){var a=d3.nest().key((function(t){return t.origin})).entries(e),d=t.selectAll("svg").data(a).enter().append("svg").attr("width",2*(radius+r+n)).attr("height",2*(radius+r+n)).append("g").attr("transform","translate("+(radius+r+n)+","+(radius+r+n)+")"),s=d3.svg.arc().innerRadius(radius/2).outerRadius(radius),l=d3.layout.pie().value((function(t){return+t.count})).sort((function(t,e){return e.count-t.count}));d.append("text").attr("dy",".35em").style("text-anchor","middle").style("font-weight",500).text((function(t){return t.key}));var u=d.selectAll("g").data((function(t){return l(t.values)})).enter().append("g").attr("class","d3-arc");u.append("path").attr("d",s).style("stroke","#fff").style("fill",(function(t){return i(t.data.carrier)})).append("title").text((function(t){return t.data.carrier+": "+t.data.count})),u.filter((function(t){return t.endAngle-t.startAngle>.2})).append("text").attr("dy",".35em").attr("transform",(function(t){return"translate("+s.centroid(t)+")rotate("+function(t){var e=90*(t.startAngle+t.endAngle)/Math.PI-90;return e>90?e-180:e}(t)+")"})).style("fill","#fff").style("font-size",12).style("text-anchor","middle").text((function(t){return t.data.carrier}))})),$(window).on("resize",d),$(".menu-toggle").on("click",d)}));